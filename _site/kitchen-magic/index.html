<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Kitchen Magic &#8211; Getting Saucy</title>
<meta name="description" content="Just some ramblings of yet another insomniatic developer">
<meta name="keywords" content="docker, test-kitchen, tooling, technical">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://blog.grubernaut.com/images/">
<meta name="twitter:title" content="Kitchen Magic">
<meta name="twitter:description" content="Just some ramblings of yet another insomniatic developer">
<meta name="twitter:creator" content="@grubernaut">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Kitchen Magic">
<meta property="og:description" content="Just some ramblings of yet another insomniatic developer">
<meta property="og:url" content="http://blog.grubernaut.com/kitchen-magic/">
<meta property="og:site_name" content="Getting Saucy">

<meta name="google-site-verification" content="ei2WLhJbqKrYSURjGsLxKrP3eSN5tN7XN5UVy9MHaJk">



<link rel="canonical" href="http://blog.grubernaut.com/kitchen-magic/">
<link href="http://blog.grubernaut.com/feed.xml" type="application/atom+xml" rel="alternate" title="Getting Saucy Feed">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://blog.grubernaut.com/assets/css/main.min.css">
<!-- Webfonts -->
<link href="http://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="http://blog.grubernaut.com/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://blog.grubernaut.com/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://blog.grubernaut.com/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://blog.grubernaut.com/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://blog.grubernaut.com/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://blog.grubernaut.com/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://blog.grubernaut.com/images/apple-touch-icon-144x144-precomposed.png">




<style type="text/css">body {background-image:url(http://blog.grubernaut.com/images/background.jpg);}</style>


</head>

<body id="post" >

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<nav id="dl-menu" class="dl-menuwrapper" role="navigation">
	<button class="dl-trigger">Open Menu</button>
	<ul class="dl-menu">
		<li><a href="http://blog.grubernaut.com">Home</a></li>
		<li>
			<a href="#">About</a>
			<ul class="dl-submenu">
				<li>
					<img src="http://blog.grubernaut.com/images/avatar.jpg" alt="Jake Champlin photo" class="author-photo">
					<h4>Jake Champlin</h4>
					<p>I'm just another insomniac working as a developer, operator, SysAd, hacker, and a student.</p>
				</li>
				<li><a href="http://blog.grubernaut.com/about/">Learn More</a></li>
				<li>
					<a href="mailto:jake.champlin.27@gmail.com"><i class="icon-envelope"></i> Email</a>
				</li>
				<li>
					<a href="http://twitter.com/grubernaut"><i class="icon-twitter"></i> Twitter</a>
				</li>
				<li>
					<a href="http://facebook.com/jake.champlin.27"><i class="icon-facebook"></i> Facebook</a>
				</li>
				
				
				<li>
					<a href="http://github.com/grubernaut"><i class="icon-github"></i> GitHub</a>
				</li>
				
				
				
				
			</ul><!-- /.dl-submenu -->
		</li>
		<li>
			<a href="#">Posts</a>
			<ul class="dl-submenu">
				<li><a href="http://blog.grubernaut.com/posts/">All Posts</a></li>
				<li><a href="http://blog.grubernaut.com/tags/">All Tags</a></li>
			</ul>
		</li>
		<li><a href="https://news.ycombinator.com">Hacker News</a></li><li><a href="http://open.spotify.com/user/1284133748">Spotify Channel</a></li>
	</ul><!-- /.dl-menu -->
</nav><!-- /.dl-menuwrapper -->




<div id="main" role="main">
  <article class="hentry">
    <header class="header-title">
      <div class="header-title-wrap">
        
          <h1 class="entry-title"><a href="http://blog.grubernaut.com/kitchen-magic/" rel="bookmark" title="Kitchen Magic">Kitchen Magic</a></h1>
        
        <h2>December 08, 2014</h2>
      </div><!-- /.header-title-wrap -->
    </header>
    <div class="entry-content">
      <h1 id="creating-some-kitchen-magic-with-puppet">Creating some kitchen magic with Puppet</h1>
<p>At my current organization (The lovely folks at <a href="http://www.minted.com">Minted</a>), we use Puppet for configuration management. At first I was fairly skeptical of using Puppet, having learned Chef in a past life, but I have given it my all. The main thing that has bugged me, however, about learning and using Puppet is the lack of a prescribed testing framework. There are other tools that are still maturing every day and actually work quite well for their designed purpose. <a href="https://github.com/puppetlabs/beaker">Beaker</a> is one such tool that works fairly well for it’s designed purpose. The only hangup that our organization had with Beaker is the dependency of a Puppet Master. We currently run a masterless Puppet, using Git and Fabric to schedule and kickoff Puppet runs on individual nodes. We needed a localized testing framework to test our Puppet manifests and modules without changing our whole internal infrastructure.</p>

<p>Some of the key requirements that we held for a testing framework were:</p>

<ol>
  <li>Local Testing</li>
  <li>Easy Integration with current testing frameworks (Serverspec, RSpec, BATS, etc…)</li>
  <li>Parallel testing</li>
  <li>Cheap</li>
  <li>Fast</li>
</ol>

<h2 id="lets-begin-cooking">Let’s begin cooking</h2>
<p>Enter <a href="https://github.com/test-kitchen/test-kitchen">Test-Kitchen</a>. Test Kitchen provides us with the framework to test all of our puppet modules, in one run, in parallel, while using a busser for our existing testing framework.
“But Wait!”, you say. “Test Kitchen is for Chef!”. This is where <a href="https://github.com/neillturner/kitchen-puppet">Kitchen-Puppet</a> comes in. Kitchen Puppet is a provisioner driver for test-kitchen. This is the same as Chef-Solo and Chef-Zero. Since our organization uses masterless puppet, this fits into our infrastructure with grace. Kitchen-Puppet allows us to use Test-Kitchen’s existing testing framework, and provision our test subject with a “puppet apply” command. Be sure to read the full set of <a href="https://github.com/neillturner/kitchen-puppet/blob/master/provisioner_options.md">Provisioner Options</a> for Kitchen-Puppet as well. Not only can you set provisioner options in the provisioner config block in the test-kitchen yaml config, but you can set provisioner options per test suite. We use this functionality at Minted to test different roles based on custom Facter Facts passed to the test suites.</p>

<p>Enter <a href="https://github.com/portertech/kitchen-docker">Kitchen-Docker</a>. Kitchen Docker allows us to have exceedingly fast tests ran against multiple test suites at the same time. Plus it’s Docker, so you know it’s cool. If you’re running on an inferior Operating System such as OSX, you’ll need to install and become familiar with <a href="http://boot2docker.io/">Boot2Docker</a> before moving any further. Our Kitchen setup takes advantage of Boot2Docker by using the “DOCKER_HOST” environment variable. Depending on how many suites you want to run and how many you want to test in a convurrent mannor, it may no longer be wise to run all of your containers locally, whether through Boot2Docker or natively. Using the environment variable “DOCKER_HOST”, it is even possible to spin up a remote EC2 instance to host all of your testing containers. This situation would be extremely beneficial for automated testing from Jenkins, TravisCI, and others.</p>

<h3 id="our-setup">Our Setup</h3>

<p>I have created a github repo for this post as well. Simply clone the repo, and test to your liking. :)
<a href="https://github.com/grubernaut/kitchen-example">grubernaut-kitchen-example</a></p>

<div class="highlight"><pre><code class="bash"><span class="lineno"> 1</span> .
<span class="lineno"> 2</span> ├── Gemfile
<span class="lineno"> 3</span> ├── Gemfile.lock
<span class="lineno"> 4</span> ├── manifests
<span class="lineno"> 5</span> │   └── site.pp
<span class="lineno"> 6</span> ├── <span class="nb">test</span>
<span class="lineno"> 7</span> │   └── integration
<span class="lineno"> 8</span> │       └── webserver
<span class="lineno"> 9</span> │           └── serverspec
<span class="lineno">10</span> │               └── default_spec.rb
<span class="lineno">11</span> └── ubuntu12.04-dockerfile
</code></pre></div>

<h3 id="mise-en-place">Mise-en-place</h3>

<p><em>Getting things setup</em></p>

<p><strong>Gemfile:</strong></p>

<div class="highlight"><pre><code class="ruby"><span class="lineno">1</span> <span class="n">source</span> <span class="s2">&quot;https://rubygems.org&quot;</span>
<span class="lineno">2</span> 
<span class="lineno">3</span> <span class="n">gem</span> <span class="s1">&#39;rake&#39;</span>
<span class="lineno">4</span> <span class="n">gem</span> <span class="s1">&#39;serverspec&#39;</span>
<span class="lineno">5</span> <span class="n">gem</span> <span class="s1">&#39;puppet&#39;</span>
<span class="lineno">6</span> <span class="n">gem</span> <span class="s1">&#39;kitchen-docker&#39;</span>
<span class="lineno">7</span> <span class="n">gem</span> <span class="s1">&#39;kitchen-puppet&#39;</span>
<span class="lineno">8</span> <span class="n">gem</span> <span class="s1">&#39;test-kitchen&#39;</span>
</code></pre></div>

<p>Notice in the following configuration file, we specifically declare which manifest to run under the provisioner hash. This is not necessary, of course, but merely a way to show how one can set provisioner-specific options for individual suites. We use this at Minted to set custom facter facts per test suite.</p>

<p><strong>.kitchen.yml:</strong></p>

<div class="highlight"><pre><code class="yaml"><span class="lineno"> 1</span> <span class="nn">---</span>
<span class="lineno"> 2</span> <span class="l-Scalar-Plain">driver</span><span class="p-Indicator">:</span>
<span class="lineno"> 3</span>   <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">docker</span>
<span class="lineno"> 4</span> 
<span class="lineno"> 5</span> <span class="l-Scalar-Plain">provisioner</span><span class="p-Indicator">:</span>
<span class="lineno"> 6</span>   <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">puppet_apply</span>
<span class="lineno"> 7</span>   <span class="l-Scalar-Plain">puppet_version</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">3.5.1-1puppetlabs1</span>
<span class="lineno"> 8</span>   <span class="l-Scalar-Plain">manifests_path</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">manifests</span>
<span class="lineno"> 9</span>   <span class="l-Scalar-Plain">modules_path</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">modules</span>
<span class="lineno">10</span>   <span class="l-Scalar-Plain">require_chef_for_busser</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">true</span>
<span class="lineno">11</span> 
<span class="lineno">12</span> <span class="l-Scalar-Plain">platforms</span><span class="p-Indicator">:</span>
<span class="lineno">13</span>   <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">ubuntu</span>
<span class="lineno">14</span>     <span class="l-Scalar-Plain">driver_config</span><span class="p-Indicator">:</span>
<span class="lineno">15</span>       <span class="l-Scalar-Plain">image</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">ubuntu:12.04</span>
<span class="lineno">16</span>       <span class="l-Scalar-Plain">socket</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">&lt;%= ENV[&#39;DOCKER_HOST&#39;] %&gt;</span>
<span class="lineno">17</span>       <span class="l-Scalar-Plain">use_cache</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">true</span>
<span class="lineno">18</span>       <span class="l-Scalar-Plain">dockerfile</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">ubuntu12.04-dockerfile</span>
<span class="lineno">19</span> 
<span class="lineno">20</span> <span class="l-Scalar-Plain">suites</span><span class="p-Indicator">:</span>
<span class="lineno">21</span>   <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">webserver</span>
<span class="lineno">22</span>     <span class="l-Scalar-Plain">provisioner</span><span class="p-Indicator">:</span>
<span class="lineno">23</span>       <span class="l-Scalar-Plain">manifest</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">site.pp</span>
</code></pre></div>

<p>One very important peice of the puzzle is the platform configuration. Here we are setting all of the settings necessary for kitchen and and kitchen-docker driver to talk to each other. Remember, if you are running Linux natively, you shouldn’t have to set a DOCKER_HOST environment variable. Unless, of course, you wish to run docker on a remote host. When running on OSX, you should already have the DOCKER_HOST environment variable set as a result of installing Boot2Docker.
We can, by all means, add custom provisioning steps to the base docker image, but I like to separate these steps out into a Dockerfile. There are, however, excellent base images for Ubuntu 14.04, see <a href="https://github.com/phusion/baseimage-docker">Phusion’s Base Docker Image</a>; but I wanted to highlight the kitchen-docker feature of including your own custom Dockerfile inside of test-kitchen. This will allow you to customize the docker images for your organization beyond the scope of a base image. And that is what I am doing here with this Dockerfile</p>

<p><strong>ubuntu12.04-dockerfile:</strong></p>

<div class="highlight"><pre><code class="bash"><span class="lineno"> 1</span> <span class="c"># Use Ubuntu Precise</span>
<span class="lineno"> 2</span> FROM ubuntu:12.04
<span class="lineno"> 3</span> 
<span class="lineno"> 4</span> <span class="c">## Basic Docker Setup for Ubuntu</span>
<span class="lineno"> 5</span> <span class="c"># Disable Upstart</span>
<span class="lineno"> 6</span> RUN dpkg-divert --local --rename --add /sbin/initctl
<span class="lineno"> 7</span> RUN ln -sf /bin/true /sbin/initctl
<span class="lineno"> 8</span> ENV DEBIAN_FRONTEND noninteractive
<span class="lineno"> 9</span> RUN apt-get -y update
<span class="lineno">10</span> RUN apt-get install -y sudo openssh-server curl lsb-release
<span class="lineno">11</span> 
<span class="lineno">12</span> <span class="c">## Add Test-Kitchen Dependencies</span>
<span class="lineno">13</span> RUN useradd -d /home/kitchen -m -s /bin/bash kitchen
<span class="lineno">14</span> RUN <span class="nb">echo</span> <span class="s1">&#39;kitchen:kitchen&#39;</span> <span class="p">|</span> chpasswd
<span class="lineno">15</span> RUN <span class="nb">echo</span> <span class="s1">&#39;kitchen ALL=(ALL) NOPASSWD:ALL&#39;</span> &gt;&gt; /etc/sudoers
</code></pre></div>

<p>Inside of the above kitchen config I added custom facter facts for the webserver suite to simply show how to set provisioner-specific options on a suite-by-suite basis. Now that we have the groundwork laid out, we need a manifest to provision. This is a very basic site manifest, but should be enough to demonstrate our purposes.</p>

<p><strong>manifests/site.pp:</strong></p>

<div class="highlight"><pre><code class="puppet"><span class="lineno"> 1</span> <span class="c-Singleline"># Install a package</span>
<span class="lineno"> 2</span> <span class="nc">package</span> <span class="p">{</span> <span class="s1">&#39;vim&#39;</span><span class="p">:</span>
<span class="lineno"> 3</span> <span class="nt">ensure</span> <span class="p">=&gt;</span> <span class="ss">installed</span><span class="p">,</span>
<span class="lineno"> 4</span> <span class="p">}</span><span class="c-Singleline"></span>
<span class="lineno"> 5</span> 
<span class="lineno"> 6</span> <span class="c-Singleline"># Install a user called snorlax</span>
<span class="lineno"> 7</span> <span class="nc">user</span> <span class="p">{</span> <span class="s1">&#39;snorlax&#39;</span><span class="p">:</span>
<span class="lineno"> 8</span> <span class="nt">ensure</span> <span class="p">=&gt;</span> <span class="s1">&#39;present&#39;</span><span class="p">,</span>
<span class="lineno"> 9</span> <span class="nt">groups</span> <span class="p">=&gt;</span> <span class="p">[</span><span class="s1">&#39;sudo&#39;</span><span class="p">],</span>
<span class="lineno">10</span> <span class="nt">home</span> <span class="p">=&gt;</span> <span class="s1">&#39;/home/snorlax&#39;</span><span class="p">,</span>
<span class="lineno">11</span> <span class="nt">managehome</span> <span class="p">=&gt;</span> <span class="ss">true</span><span class="p">,</span>
<span class="lineno">12</span> <span class="nt">shell</span> <span class="p">=&gt;</span> <span class="s1">&#39;/bin/bash&#39;</span><span class="p">,</span>
<span class="lineno">13</span> <span class="p">}</span>
</code></pre></div>

<p>We also need to write a serverspec test for the manifest above. Again, keeping with our simple theme, we should test all of the resources that we have defined in our manifest. Notice the file path for the serverspec test. This is required by the test-kitchen busser, which we will talk about later.</p>

<p><strong>test/integration/webserver/serverspec/default_spec.rb:</strong></p>

<div class="highlight"><pre><code class="ruby"><span class="lineno"> 1</span> <span class="c1"># Encoding: utf-8</span>
<span class="lineno"> 2</span> <span class="nb">require</span> <span class="s1">&#39;serverspec&#39;</span>
<span class="lineno"> 3</span> 
<span class="lineno"> 4</span> <span class="n">set</span> <span class="ss">:backend</span><span class="p">,</span> <span class="ss">:exec</span>
<span class="lineno"> 5</span> <span class="n">set</span> <span class="ss">:path</span><span class="p">,</span> <span class="s1">&#39;/sbin:/usr/local/sbin:$PATH&#39;</span>
<span class="lineno"> 6</span> 
<span class="lineno"> 7</span> <span class="n">describe</span> <span class="n">package</span><span class="p">(</span><span class="s1">&#39;vim&#39;</span><span class="p">)</span> <span class="k">do</span>
<span class="lineno"> 8</span>   <span class="n">it</span> <span class="p">{</span> <span class="n">should</span> <span class="n">be_installed</span> <span class="p">}</span>
<span class="lineno"> 9</span> <span class="k">end</span>
<span class="lineno">10</span> 
<span class="lineno">11</span> <span class="n">describe</span> <span class="n">user</span><span class="p">(</span><span class="s1">&#39;snorlax&#39;</span><span class="p">)</span> <span class="k">do</span>
<span class="lineno">12</span>   <span class="n">it</span> <span class="p">{</span> <span class="n">should</span> <span class="n">exist</span> <span class="p">}</span>
<span class="lineno">13</span> <span class="k">end</span>
</code></pre></div>

<p>We should have the groundwork all laid out for our testing to begin.</p>

<h3 id="fire-ze-missiles">Fire ‘Ze Missiles!!!</h3>

<p>We need gems installed,of course, to be able to test our infrastructure that we are creating.</p>

<div class="highlight"><pre><code class="bash">% bundle install
</code></pre></div>

<p>Once all of our gems are installed, we should be able to run test-kitchen and see our instance suite waiting to be converged:</p>

<div class="highlight"><pre><code class="bash">% kitchen list
Instance              Driver  Provisioner  Last Action
webserver-ubuntu      Docker  PuppetApply  Created
</code></pre></div>

<p>If everything went smoothly, we should be able to now Create, Converge, and Test our “webserver” instance. Notice how test-kitchen actually installs chef during the output of the following command:</p>

<div class="highlight"><pre><code class="bash">% kitchen converge webserver-ubuntu
Installing Chef
installing with dpkg...
Selecting previously unselected package chef.
<span class="o">(</span>Reading database ...
<span class="o">(</span>Reading database ...        39770 files and directories currently installed.<span class="o">)</span>
Unpacking chef <span class="o">(</span>from .../chef_12.0.3-1_amd64.deb<span class="o">)</span> ...
Setting up chef <span class="o">(</span>12.0.3-1<span class="o">)</span> ...
Thank you <span class="k">for </span>installing Chef!
Transfering files to &lt;webserver-ubuntu&gt;
</code></pre></div>

<p>We actually want Test-Kitchen to behave in this fashion. This allows us to use chef-busser for all of our tests. Which is the real point of this whole project! Now we can run “kitchen test” and test-kitchen will create our docker instance, provision the instance with puppet, test the instance with serverspec, and then destroy our instance. All in one command:</p>

<div class="highlight"><pre><code class="bash">Finished converging &lt;webserver-ubuntu&gt; <span class="o">(</span>1m51.92s<span class="o">)</span>.
-----&gt; Setting up &lt;webserver-ubuntu&gt;...
Fetching: thor-0.19.0.gem <span class="o">(</span>100%<span class="o">)</span>
Successfully installed thor-0.19.0
Fetching: busser-0.6.2.gem <span class="o">(</span>100%<span class="o">)</span>
Successfully installed busser-0.6.2
2 gems installed
-----&gt; Setting up Busser
Creating BUSSER_ROOT in /tmp/busser
Creating busser binstub
Plugin serverspec installed <span class="o">(</span>version 0.5.3<span class="o">)</span>
-----&gt; Running postinstall <span class="k">for </span>serverspec plugin
Finished setting up &lt;webserver-ubuntu&gt; <span class="o">(</span>0m9.15s<span class="o">)</span>.
-----&gt; Verifying &lt;webserver-ubuntu&gt;...
Suite path directory /tmp/busser/suites does not exist, skipping.
Uploading /tmp/busser/suites/serverspec/default_spec.rb <span class="o">(</span><span class="nv">mode</span><span class="o">=</span>0644<span class="o">)</span>
-----&gt; Running serverspec <span class="nb">test </span>suite
-----&gt; Installing Serverspec..
Fetching: net-ssh-2.9.1.gem <span class="o">(</span>100%<span class="o">)</span>
Fetching: net-scp-1.2.1.gem <span class="o">(</span>100%<span class="o">)</span>
Fetching: specinfra-2.10.4.gem <span class="o">(</span>100%<span class="o">)</span>
Fetching: multi_json-1.10.1.gem <span class="o">(</span>100%<span class="o">)</span>
Fetching: diff-lcs-1.2.5.gem <span class="o">(</span>100%<span class="o">)</span>
Fetching: rspec-support-3.1.2.gem <span class="o">(</span>100%<span class="o">)</span>
Fetching: rspec-expectations-3.1.2.gem <span class="o">(</span>100%<span class="o">)</span>
Fetching: rspec-core-3.1.7.gem <span class="o">(</span>100%<span class="o">)</span>
Fetching: rspec-its-1.1.0.gem <span class="o">(</span>100%<span class="o">)</span>
Fetching: rspec-mocks-3.1.3.gem <span class="o">(</span>100%<span class="o">)</span>
Fetching: rspec-3.1.0.gem <span class="o">(</span>100%<span class="o">)</span>
Fetching: serverspec-2.7.1.gem <span class="o">(</span>100%<span class="o">)</span>
-----&gt; serverspec installed <span class="o">(</span>version 2.7.1<span class="o">)</span>
/opt/chef/embedded/bin/ruby -I/tmp/busser/suites/serverspec -I/tmp/busser/gems/gems/rspec-support-3.1.2/lib:/tmp/busser/gems/gems/rspec-core-3.1.7/lib /opt/chef/embedded/bin/rspec --pattern /tmp/busser/suites/serverspec/<span class="se">\*\*</span>/<span class="se">\*</span>_spec.rb --color --format documentation --default-path /tmp/busser/suites/serverspec

Package <span class="s2">&quot;vim&quot;</span>
should be installed

User <span class="s2">&quot;snorlax&quot;</span>
should exist

Finished in 0.05471 seconds <span class="o">(</span>files took 0.17188 seconds to load<span class="o">)</span>
2 examples, 0 failures
Finished verifying &lt;webserver-ubuntu&gt; <span class="o">(</span>0m7.45s<span class="o">)</span>.
</code></pre></div>

<p>You can also run “kitchen verify” to test an already running instance without destroying the instance.</p>

<p>Hopefully this helps you setup and start testing your puppet infrastructure using Test-Kitchen, Puppet, and Docker!</p>

      <footer class="entry-meta">
        <span class="entry-tags"><a href="http://blog.grubernaut.com/tags/#docker" title="Pages tagged docker" class="tag">docker</a><a href="http://blog.grubernaut.com/tags/#test-kitchen" title="Pages tagged test-kitchen" class="tag">test-kitchen</a><a href="http://blog.grubernaut.com/tags/#tooling" title="Pages tagged tooling" class="tag">tooling</a><a href="http://blog.grubernaut.com/tags/#technical" title="Pages tagged technical" class="tag">technical</a></span>
        <span><a href="http://blog.grubernaut.com/kitchen-magic/" rel="bookmark" title="Kitchen Magic">Kitchen Magic</a> was published on <span class="entry-date date published updated"><time datetime="2014-12-08T00:00:00-05:00">December 08, 2014</time></span></span>
        (revised: <span class="entry-date date modified"><time datetime="2014-12-08 17:50:10 UTC">12/08/2014</time></span>)
        <span class="author vcard"><span class="fn"><a href="http://blog.grubernaut.com/about/" title="About Jake Champlin">Jake Champlin</a></span></span>
        <div class="social-share">
          <ul class="socialcount socialcount-small inline-list">
            <li class="facebook"><a href="https://www.facebook.com/sharer/sharer.php?u=http://blog.grubernaut.com/kitchen-magic/" title="Share on Facebook"><span class="count"><i class="icon-facebook-sign"></i> Like</span></a></li>
            <li class="twitter"><a href="https://twitter.com/intent/tweet?text=http://blog.grubernaut.com/kitchen-magic/" title="Share on Twitter"><span class="count"><i class="icon-twitter-sign"></i> Tweet</span></a></li>
            <li class="googleplus"><a href="https://plus.google.com/share?url=http://blog.grubernaut.com/kitchen-magic/" title="Share on Google Plus"><span class="count"><i class="icon-google-plus-sign"></i> +1</span></a></li>
          </ul>
        </div><!-- /.social-share -->
      </footer>
    </div><!-- /.entry-content -->
    <section id="disqus_thread"></section><!-- /#disqus_thread -->
    
    <div class="read-more">
      
        <div class="read-more-header">
          <a href="http://blog.grubernaut.com/some-brief-history/" class="read-more-btn">Read More</a>
        </div><!-- /.read-more-header -->
        <div class="read-more-content">
          <h3><a href="http://blog.grubernaut.com/some-brief-history/" title="Some Brief History">Some Brief History</a></h3>
          <p>  “Life is like topography, Hobbes. There are summits of happiness and success, flat stretches of boring routine and valleys of frustrati...&hellip; <a href="http://blog.grubernaut.com/some-brief-history/">Continue reading</a></p>
        </div><!-- /.read-more-content -->
      
      <div class="read-more-list">
        
          <div class="list-item">
            <h4><a href="http://blog.grubernaut.com/vps-migration/" title="Setting up a Continuous Delivery Blog">Setting up a Continuous Delivery Blog</a></h4>
            <span>Published on June 21, 2014</span>
          </div><!-- /.list-item -->
        
          <div class="list-item">
            <h4><a href="http://blog.grubernaut.com/the-effects-of-a-devops-community/" title="The effects of a DevOps community">The effects of a DevOps community</a></h4>
            <span>Published on June 02, 2014</span>
          </div><!-- /.list-item -->
        
      </div><!-- /.read-more-list -->
      
    </div><!-- /.read-more -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2014 Jake Champlin. Powered by <a
		href="http://jekyllrb.com">Jekyll</a> and <a
		href="http://github.com/mmistkes">Made Mistakes</a>.</span>

  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://blog.grubernaut.com/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://blog.grubernaut.com/assets/js/scripts.min.js"></script>

<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-50680600-1', 'auto');  
  ga('require', 'linkid', 'linkid.js');
  ga('send', 'pageview');
</script>

<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'jchamplin-landing'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>	        

</body>
</html>
